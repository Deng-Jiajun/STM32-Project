# TIMï¼ˆTimerï¼‰å®šæ—¶å™¨

å®šæ—¶å™¨å¯ä»¥å¯¹è¾“å…¥çš„æ—¶é’Ÿè¿›è¡Œè®¡æ•°ï¼Œå¹¶åœ¨è®¡æ•°å€¼è¾¾åˆ°è®¾å®šå€¼æ—¶è§¦å‘ä¸­æ–­

<u>16 ä½è®¡æ•°å™¨ã€é¢„åˆ†é¢‘å™¨ã€è‡ªåŠ¨é‡è£…å¯„å­˜å™¨</u>çš„æ—¶åŸºå•å…ƒï¼Œåœ¨ 72MHz è®¡æ•°æ—¶é’Ÿä¸‹å¯ä»¥å®ç°æœ€å¤§ 59.65s çš„å®šæ—¶ï¼ˆ$\mathrm{\frac{1}{(72M / 2^{16} / 2^{16}}}$ï¼‰

å®šæ—¶å™¨ä¸ä»…å…·å¤‡åŸºæœ¬çš„å®šæ—¶ä¸­æ–­åŠŸèƒ½ï¼Œè€Œä¸”è¿˜åŒ…å«å†…å¤–æ—¶é’Ÿæºé€‰æ‹©ã€è¾“å…¥æ•è·ã€è¾“å‡ºæ¯”è¾ƒã€ç¼–ç å™¨æ¥å£ã€ä¸»ä»è§¦å‘æ¨¡å¼ç­‰å¤šç§åŠŸèƒ½

## å®šæ—¶å™¨ç±»å‹

å®šæ—¶å™¨æ ¹æ®å¤æ‚åº¦å’Œåº”ç”¨åœºæ™¯åˆ†ä¸ºäº†é«˜çº§å®šæ—¶å™¨ã€é€šç”¨å®šæ—¶å™¨ã€åŸºæœ¬å®šæ—¶å™¨ä¸‰ç§ç±»å‹

![image-20220416205630019](img/image-20220416205630019.png)

> ğŸ’¡å®šæ—¶å™¨æ¡†å›¾é‡Œå¸¦é˜´å½±æ•ˆæœçš„å¯„å­˜å™¨ï¼Œéƒ½æ˜¯æœ‰ç¼“å†²å¯„å­˜å™¨ï¼ˆå½±å­å¯„å­˜å™¨ï¼‰çš„

### åŸºæœ¬å®šæ—¶å™¨

> [åŸºæœ¬å®šæ—¶å™¨æ¡†å›¾](bookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=297&x=177&y=439&id=134)

![image-20220416210203470](img/image-20220416210203470.png)

å†…éƒ¨æ—¶é’Ÿç»™å‡ºæ—¶é’ŸåŸºå‡† => ç»è¿‡é¢„åˆ†é¢‘å™¨åˆ†é¢‘ï¼ˆ0 å¯¹åº”ä¸åˆ†é¢‘ï¼Œ1 å¯¹åº”åˆ†é¢‘ 2å€â€¦â€¦ï¼‰=> CNT è®¡æ•°å™¨è‡ªå¢å¹¶å’Œè‡ªåŠ¨é‡è£…è½½å¯„å­˜å™¨æ¯”å¯¹æ•°å€¼ï¼Œå½“æ•°å€¼ç›¸ç­‰ï¼Œå¼•å‘ä¸­æ–­ï¼ˆæˆ–äº§ç”Ÿäº‹ä»¶ï¼‰å¹¶ä»åˆå€¼å¼€å§‹å†æ¬¡ä» 0 å¼€å§‹è®¡æ•°

### é€šç”¨å®šæ—¶å™¨

> [é€šç”¨å®šæ—¶å™¨æ¡†å›¾](bookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=253&x=177&y=63&id=135)

![image-20220416210833408](img/image-20220416210833408.png)



- åŸºæœ¬å®šæ—¶å™¨åªæ”¯æŒå‘ä¸Šè®¡æ•°ï¼ˆé€’å¢ï¼‰ï¼Œé€šç”¨å’Œé«˜çº§å®šæ—¶å™¨æ”¯æŒå‘ä¸‹ï¼ˆé€’å‡ï¼‰å’Œå¯¹é½ï¼ˆ0â†’Nâ†’0â†’Nâ€¦ï¼‰è®¡æ•°
- åŸºæœ¬å®šæ—¶å™¨åªèƒ½é€‰æ‹©å†…éƒ¨æ—¶é’Ÿï¼Œé€šç”¨å®šæ—¶å™¨å¼€å§‹æ”¯æŒå¤–éƒ¨æ—¶é’Ÿ
  - æˆ‘æ™•äº†ï¼ˆæ—¶é’Ÿè¾“å…¥éƒ¨åˆ†ï¼‰ï¼šhttps://www.bilibili.com/video/BV1th411z7sn?p=13&t=1146.9

### é«˜çº§å®šæ—¶å™¨

> [é«˜çº§å®šæ—¶å™¨æ¡†å›¾](bookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=199&x=188&y=63&id=136)

![image-20220416215730979](img/image-20220416215730979.png)

## é¢„åˆ†é¢‘å™¨æ—¶åºå›¾

> from [å‚è€ƒæ‰‹å†Œ](bookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=200&x=252&y=260&id=144)

![image-20220416223251796](img/image-20220416223251796.png)

## è®¡æ•°å™¨æ—¶åºå›¾

> from [å‚è€ƒæ‰‹å†Œ](bookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=201&x=228&y=572&id=157)

![image-20220416224657663](img/image-20220416224657663.png)

## æ—¶é’Ÿæ ‘

> from [å‚è€ƒæ‰‹å†Œ](bookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=55&x=156&y=63&id=169)

![image-20220417000122430](img/image-20220417000122430.png)

# å®šæ—¶å™¨ä¸­æ–­å®ç°

![image-20220419035252721](img/image-20220419035252721.png)



## å®šæ—¶å™¨åˆå§‹åŒ–å‡½æ•°

```c
// å®šæ—¶å™¨2åˆå§‹åŒ–ï¼Œé¢‘ç‡ä¸º1Hzï¼ˆ1 ç§’ä¸­æ–­ä¸€æ¬¡ï¼‰
void Timer_Init(void)
{
	TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
	NVIC_InitTypeDef NVIC_InitStructure;

	// å¼€å¯å®šæ—¶å™¨2çš„æ—¶é’Ÿ
	RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE);

	// ä½¿ç”¨å†…éƒ¨æ—¶é’Ÿï¼ˆæ²¡é…ç½®çš„è¯ï¼Œé»˜è®¤å°±æ˜¯å†…éƒ¨æ—¶é’Ÿï¼Œæ‰€ä»¥è¿™å¥å¯ä»¥ä¸å†™ï¼‰
	TIM_InternalClockConfig(TIM2);

	/*
	TIM_Prescaler = 7200-1ï¼Œ72MHz è¿›è¡Œ 7200 åˆ†é¢‘ï¼Œå¾—åˆ° 10kHzï¼Œå³è®¡æ•°é¢‘ç‡ä¸º 10kHz
	TIM_Period    = 10000-1ï¼Œè®¡æ•°å™¨ä»¥ 10kHz è®¡æ•° 10000 æ¬¡ï¼Œå³ 1s
	 */
	// åˆå§‹åŒ–å®šæ—¶å™¨2çš„æ—¶åŸºå•å…ƒ
	TIM_TimeBaseInitStructure.TIM_Period = 10000;					// å‘¨æœŸï¼ˆ=è‡ªåŠ¨é‡è£…å™¨çš„å€¼ï¼‰
	TIM_TimeBaseInitStructure.TIM_Prescaler = 7200 - 1;				// é¢„åˆ†é¢‘å™¨çš„å€¼
	TIM_TimeBaseInitStructure.TIM_ClockDivision = TIM_CKD_DIV1;		// é‡‡æ ·é¢‘ç‡åˆ†é¢‘ç³»æ•°
	TIM_TimeBaseInitStructure.TIM_CounterMode = TIM_CounterMode_Up; // å‘ä¸Šè®¡æ•°æ¨¡å¼
	// TIM_TimeBaseInitStructure.TIM_RepetitionCounter = 0; // é‡å¤è®¡æ•°å™¨çš„å€¼ï¼ŒTIM1 å’Œ TIM8 æ‰æœ‰æ•ˆ
	TIM_TimeBaseInit(TIM2, &TIM_TimeBaseInitStructure);

	// å¼€å¯å®šæ—¶å™¨2çš„ä¸­æ–­
	TIM_ITConfig(TIM2, TIM_IT_Update, ENABLE);

	// åˆå§‹åŒ– NVIC
	NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;			  // ä¸­æ–­é€šé“
	NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0; // æŠ¢å ä¼˜å…ˆçº§
	NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;		  // å“åº”ä¼˜å…ˆçº§
	NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;			  // é€šé“ä½¿èƒ½
	NVIC_Init(&NVIC_InitStructure);

	// å¯åŠ¨å®šæ—¶å™¨2
	TIM_Cmd(TIM2, ENABLE);
}
```

### å…³äº `TIM_ClockDivision`

è¿™é‡Œç»™å‡ºæ—¶åŸºå•å…ƒåˆå§‹åŒ–çš„ç»“æ„ä½“

```c
typedef struct
{
    uint16_t TIM_Prescaler;
    uint16_t TIM_CounterMode;
    uint16_t TIM_Period;  
    uint16_t TIM_ClockDivision;  
    uint8_t TIM_RepetitionCounter;
} TIM_TimeBaseInitTypeDef;  
```

å…¶ä¸­ `TIM_ClockDivision` æœ‰ç‚¹ç‰¹åˆ«ï¼Œå®ƒçš„æ³¨é‡Šè¯´ï¼š

> Specifies the clock division.
>
> ï¼ˆæŒ‡å®šæ—¶é’Ÿåˆ†é¢‘ï¼‰



è¯´ç™½äº†å°±æ˜¯é…ç½®æ—¶é’Ÿåˆ†é¢‘ï¼Œé‚£æ˜¯è°çš„æ—¶é’Ÿåˆ†é¢‘ï¼Ÿç¬¬ä¸€ååº”è‚¯å®šæ˜¯**å®šæ—¶å™¨çš„æ—¶é’Ÿåˆ†é¢‘å•Š**



ä½†æ˜¯è¿˜æœ‰ä¸€é¡¹ `TIM_Prescaler`ï¼Œå®ƒçš„æ³¨é‡Šæ˜¯ï¼š

> Specifies the prescaler value used to divide the TIM clock.
>
> ï¼ˆæŒ‡å®šç”¨äºåˆ†é¢‘ TIME æ—¶é’Ÿçš„é¢„åˆ†é¢‘å™¨å€¼ï¼‰

æ˜¾ç„¶ `TIM_Prescaler`Â æ‰æ˜¯é…ç½®å®šæ—¶å™¨çš„æ—¶é’Ÿåˆ†é¢‘çš„



å®é™…ä¸Š `TIM_ClockDivision` æ˜¯è®¾ç½®å†…éƒ¨æ—¶é’Ÿï¼ˆCK_INTï¼‰é¢‘ç‡ä¸æ•°å­—æ»¤æ³¢å™¨ï¼ˆETRï¼ŒTIxï¼‰ä½¿ç”¨çš„é‡‡æ ·é¢‘ç‡ä¹‹é—´çš„åˆ†é¢‘æ¯”ä¾‹çš„ï¼ˆä¸è¾“å…¥æ•è·ç›¸å…³ï¼‰ï¼Œ0ï¼ˆTIM_CKD_DIV1ï¼‰ è¡¨ç¤ºæ»¤æ³¢å™¨çš„é¢‘ç‡å’Œå®šæ—¶å™¨çš„é¢‘ç‡æ˜¯ä¸€æ ·çš„ï¼ˆä¸åˆ†é…ï¼‰

## å®šæ—¶å™¨ä¸­æ–­å¤„ç†å‡½æ•°

```c
void TIM2_IRQHandler(void)
{
	// åˆ¤æ–­çš„å®šæ—¶å™¨ä¸­æ–­æºæ˜¯åˆå§‹åŒ–çš„æ—¶è®¾å®šçš„ TIM_IT_Update
	if (TIM_GetITStatus(TIM2, TIM_IT_Update) == SET) // æ£€æŸ¥æ›´æ–°ä¸­æ–­å‘ç”Ÿä¸å¦
	{
		counter++; //counter æ˜¯ main.c è®¾ç½®çš„ä¸€ä¸ªå…¨å±€å˜é‡
		TIM_ClearITPendingBit(TIM2, TIM_IT_Update); // æ¸…é™¤ä¸­æ–­æ ‡å¿—
	}
}
```

ä¸»å‡½æ•°é€šè¿‡ OLED æ˜¾ç¤ºcounterï¼š

```c
OLED_Init();
Timer_Init();
OLED_ShowString(1, 1, "Counter:");
while (1)
{
    OLED_ShowNum(1, 9, counter,5);
}
```

> å®éªŒå‘ç°è®¡æ•°æ¯æ¬¡éƒ½æ˜¯ä» 1 å¼€å§‹ï¼Œè¿™å’Œ `TIM_TimeBaseInit()`Â çš„å®ç°æœ‰å…³

### å…³äº `TIM_TimeBaseInit()`

è¿™é‡Œç»™å‡º `TIM_TimeBaseInit()`Â çš„éƒ¨åˆ†ä»£ç 

```c
void TIM_TimeBaseInit(TIM_TypeDef* TIMx, TIM_TimeBaseInitTypeDef* TIM_TimeBaseInitStruct)
{
    ...
  /* Generate an update event to reload the Prescaler and the Repetition counter values immediately */
  TIMx->EGR = TIM_PSCReloadMode_Immediate;           
}
```

åœ¨ `TIM_TimeBaseInit()` çš„æœ€åä¸€å¥è¯­å¥å‰ï¼Œæœ‰è¿™å¥æ³¨é‡Š

> Generate an update event to reload the Prescaler and the Repetition counter values immediately
>
> ï¼ˆç”Ÿæˆä¸€ä¸ªæ›´æ–°äº‹ä»¶ï¼Œ**ç«‹å³**é‡æ–°åŠ è½½é¢„åˆ†é¢‘å™¨å’Œé‡å¤è®¡æ•°å™¨çš„å€¼ï¼‰

å‰é¢æåŠç”±äºå­˜åœ¨ç¼“å­˜å¯„å­˜å™¨ï¼ˆå½±å­å¯„å­˜å™¨ï¼‰è¿™ä¸€è®¾è®¡ï¼Œé¢„åˆ†é¢‘ç³»æ•°å¹¶ä¸ä¼šç«‹å³ç”Ÿæ•ˆï¼ˆåªæœ‰åœ¨å¼•å‘ä¸­æ–­ï¼Œä¹Ÿå°±æ˜¯æ›´æ–°äº‹ä»¶åï¼Œæ‰å¼€å§‹ç”Ÿæ•ˆï¼‰ï¼Œå› æ­¤ä¸ºäº†è®©è¯¥å€¼ç«‹å³ç”Ÿæ•ˆï¼Œè¿™é‡Œæ‰‹åŠ¨äº§ç”Ÿäº†ä¸€ä¸ªæ›´æ–°äº‹ä»¶

> æ¯æ¬¡è®¡æ•°å™¨æº¢å‡ºæ—¶å¯ä»¥äº§ç”Ÿæ›´æ–°äº‹ä»¶ï¼Œåœ¨ `TIMx_EGR` å¯„å­˜å™¨ä¸­(é€šè¿‡è½¯ä»¶æ–¹å¼æˆ–è€…ä½¿ç”¨ä»æ¨¡å¼æ§åˆ¶å™¨)è®¾ç½® `UG` ä½ä¹ŸåŒæ ·å¯ä»¥äº§ç”Ÿä¸€ä¸ªæ›´æ–°äº‹ä»¶ã€‚ï¼ˆfrom [å‚è€ƒæ‰‹å†Œ](bookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=254&x=319&y=756&id=189)ï¼‰



æ²¡å•¥å¥½è¯´çš„äº†ï¼Œä¸Šå›¾ğŸ‘‡

![image-20220419053904261](img/image-20220419053904261.png)



å› ä¸ºä¸Šè¿°åŸå› ï¼Œæ‰€ä»¥**æ¯æ¬¡åˆå§‹åŒ–å®Œæ¯•ä¹‹åï¼Œå°±ä¼šç«‹åˆ»è¿›å…¥ä¸­æ–­**ï¼ˆå•ç‰‡æœºä¸€ä¸Šç”µå°±è¿›å…¥ä¸­æ–­ï¼‰

è§£å†³æ–¹æ³•ä¸ºï¼šåœ¨ `TIM_TimeBaseInit()`Â ä¹‹åå°†æ ‡å¿—ä½æ¸…é™¤

```c
Â·Â·Â·
TIM_TimeBaseInit(TIM2, &TIM_TimeBaseInitStructure); // åˆå§‹åŒ–å®šæ—¶å™¨2çš„æ—¶åŸºå•å…ƒ
TIM_ClearFlag(TIM2, TIM_FLAG_Update); // æ¸…é™¤æ›´æ–°æ ‡å¿—ï¼ˆé¿å…ä¸€ä¸Šç”µå°±è§¦å‘ä¸­æ–­ï¼‰
TIM_ITConfig(TIM2, TIM_IT_Update, ENABLE); // å¼€å¯å®šæ—¶å™¨2çš„ä¸­æ–­ï¼Œå®šæ—¶å™¨ä¸­æ–­æºä¸º TIM_IT_Update
Â·Â·Â·
```



## æµ‹è¯•ç”¨ä¸»å‡½æ•°

```c
uint16_t counter = 0;
int main(void)
{
	OLED_Init();
	Timer_Init();
	OLED_ShowString(1, 1, "Counter:");
	OLED_ShowString(2, 1, "CNT:");
	while (1)
	{
		OLED_ShowNum(1, 9, counter,5);
		/* TIM_Period=10000ï¼Œå¯ä»¥çœ‹åˆ° OLED ä¸Š CNT ä» 0~9999 å¾ªç¯
		   ä¿®æ”¹ TIM_Periodã€TIM_Prescaler çš„å€¼ï¼Œå¯ä»¥çœ‹åˆ°ç›¸åº”çš„å˜åŒ– */
		OLED_ShowNum(2, 9, TIM_GetCounter(TIM2),5); 
	}
}
```

# å®šæ—¶å™¨å¤–éƒ¨ä¸­æ–­å®ç°

å†™åˆ°ä¸€åŠå‘ç°æˆ‘æ²¡æœ‰æ¡ä»¶è§¦å‘å¤ç”¨IOğŸ˜“ï¼Œæœ€åç”¨å›å½¢é’ˆæ‘¸é˜µè„šå®ç°äº†â€¦â€¦ï¼ˆä¸è¿‡è§¦å‘çš„ä¸å¤ªç¨³å®šï¼Œæœ‰æ—¶å€™è¿æ¡å¥½å‡ ä¸ªæ•°ï¼Œæ¯•ç«Ÿæ˜¯æ‰‹æ“ï¼‰

è¿™é‡Œç»™å‡ºå®ç°ï¼š

> å’Œå†…éƒ¨æ—¶é’Ÿç›¸æ¯”åªæ˜¯ä¿®æ”¹äº†æ—¶é’Ÿï¼Œç„¶åé…ç½®äº† GPIOAï¼ˆç”¨äºå¤–éƒ¨æ—¶é’Ÿå¤ç”¨ï¼‰

```c
void External_Clock_Timer_Init(void)
{
	TIM_TimeBaseInitTypeDef TIM_TimeBaseInitStructure;
	NVIC_InitTypeDef NVIC_InitStructure;
	GPIO_InitTypeDef GPIO_InitStructure;

	// å¼€å¯å®šæ—¶å™¨2çš„æ—¶é’Ÿ
	RCC_APB1PeriphClockCmd(RCC_APB1Periph_TIM2, ENABLE);

	// å¼€å¯GPIOAçš„æ—¶é’Ÿ
	RCC_APB2PeriphClockCmd(RCC_APB2Periph_GPIOA, ENABLE);

	// åˆå§‹åŒ– GPIOA
	GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0;
	GPIO_InitStructure.GPIO_Mode = GPIO_Mode_IPU;
	GPIO_Init(GPIOA, &GPIO_InitStructure);

	// ä½¿ç”¨å¤–éƒ¨æ—¶é’Ÿ
	// å®šæ—¶å™¨2ï¼Œä¸åˆ†é¢‘ï¼Œé«˜ç”µå¹³/ä¸Šå‡æ²¿è§¦å‘ï¼Œä¸ç”¨æ»¤æ³¢å™¨ï¼ˆbookxnotepro://opennote/?nb={01a25f6c-fe16-454c-8f38-591392487e16}&book=47f07b86a273b11dbbc9034f7a90f448&page=283&x=176&y=448&id=193ï¼‰
	TIM_ETRClockMode2Config(TIM2, TIM_ExtTRGPSC_OFF, TIM_ExtTRGPolarity_NonInverted, 0);

	/*
	TIM_Prescaler = 0ï¼Œä¸åˆ†é¢‘
	TIM_Period    = 10-1ï¼Œæ•°åˆ° 10 ä¸­æ–­ä¸€æ¬¡
	 */
	// åˆå§‹åŒ–å®šæ—¶å™¨2çš„æ—¶åŸºå•å…ƒ
	TIM_TimeBaseInitStructure.TIM_Period = 10;					// å‘¨æœŸï¼ˆ=è‡ªåŠ¨é‡è£…å™¨çš„å€¼ï¼‰
	TIM_TimeBaseInitStructure.TIM_Prescaler = 1 - 1;				// é¢„åˆ†é¢‘å™¨çš„å€¼
	TIM_TimeBaseInitStructure.TIM_ClockDivision = TIM_CKD_DIV1;		// é‡‡æ ·é¢‘ç‡åˆ†é¢‘ç³»æ•°
	TIM_TimeBaseInitStructure.TIM_CounterMode = TIM_CounterMode_Up; // å‘ä¸Šè®¡æ•°æ¨¡å¼
	// TIM_TimeBaseInitStructure.TIM_RepetitionCounter = 0; // é‡å¤è®¡æ•°å™¨çš„å€¼ï¼ŒTIM1 å’Œ TIM8 æ‰æœ‰æ•ˆ
	TIM_TimeBaseInit(TIM2, &TIM_TimeBaseInitStructure);

	TIM_ClearFlag(TIM2, TIM_FLAG_Update); // æ¸…é™¤æ›´æ–°æ ‡å¿—ï¼ˆé¿å…ä¸€ä¸Šç”µå°±è§¦å‘ä¸­æ–­ï¼‰

	// å¼€å¯å®šæ—¶å™¨2çš„ä¸­æ–­ï¼Œå®šæ—¶å™¨ä¸­æ–­æºä¸º TIM_IT_Update
	TIM_ITConfig(TIM2, TIM_IT_Update, ENABLE);

	// åˆå§‹åŒ– NVIC
	NVIC_InitStructure.NVIC_IRQChannel = TIM2_IRQn;			  // ä¸­æ–­é€šé“
	NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0; // æŠ¢å ä¼˜å…ˆçº§
	NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;		  // å“åº”ä¼˜å…ˆçº§
	NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;			  // é€šé“ä½¿èƒ½
	NVIC_Init(&NVIC_InitStructure);

	// å¯åŠ¨å®šæ—¶å™¨2
	TIM_Cmd(TIM2, ENABLE);
}
```

